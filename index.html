<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nightfall Cinematheque — Horror Movies Experience</title>
  <link rel="stylesheet" href="styles.css">
  <meta name="description" content="An immersive horror movies experience — trailers, curated picks, ambient audio, and cinematic effects.">
</head>
<body>
  <div id="ambient"></div>

  <header class="site-header">
    <div class="brand">
      <svg width="48" height="48" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2L2 7v7c0 5 4 9 10 9s10-4 10-9V7l-10-5z"/></svg>
      <h1>Nightfall Cinematheque</h1>
    </div>
    <nav>
      <button id="audioToggle" aria-pressed="false" title="Toggle ambient audio">Enable Ambience</button>
      <button id="nightModeToggle" title="Enter Nightmare Mode">Nightmare Mode</button>
    </nav>
  </header>

  <main>
    <section class="hero" id="hero">
      <div class="hero-inner">
        <h2 class="flicker">Tonight's Feature</h2>
        <p class="lead">Enter if you dare — curated horror, immersive audio & cinematic glitches.</p>
        <div class="cta-row">
          <button class="cta primary" data-action="explore">Explore Collection</button>
          <button class="cta ghost" id="playTrailer" data-trailer="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1">Play Trailer</button>
        </div>
        <div class="scanlines" aria-hidden="true"></div>
        <div class="vhs-glow" aria-hidden="true"></div>
      </div>
    </section>

    <section class="collection" id="collection" aria-label="Horror picks">
      <h3>Curated Picks</h3>
      <div class="cards">
        <!-- Example card, duplicate/replace for more movies -->
        <article class="card" tabindex="0" data-video="https://www.youtube.com/embed/dQw4w9WgXcQ">
          <div class="poster" style="background-image:url('https://images.unsplash.com/photo-1517604931442-3d33a8a961a1?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder');">
            <div class="glitch"></div>
          </div>
          <div class="meta">
            <h4>Axis of Night</h4>
            <p class="tagline">A whisper in the walls, a light that never reaches the porch.</p>
            <div class="meta-actions">
              <button class="btn-play">Watch Trailer</button>
              <button class="btn-more">Details</button>
            </div>
          </div>
        </article>
        <!-- Add more cards here -->
      </div>
    </section>

    <section class="immersive" id="immersive">
      <h3>Immersive Mode</h3>
      <p>Slow scroll to step through three cinematic chapters — the site will alter atmosphere and audio.</p>
      <div class="scenes">
        <div class="scene">Chapter I — Arrival</div>
        <div class="scene">Chapter II — The Echo</div>
        <div class="scene">Chapter III — The Hollow</div>
      </div>
    </section>

  </main>

  <footer>
    <small>&copy; Nightfall Cinematheque — For best experience use headphones. Press <kbd>m</kbd> to toggle ambience.</small>
  </footer>

  <!-- Trailer Modal -->
  <div id="modal" class="modal" role="dialog" aria-hidden="true" aria-label="Trailer">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-panel" role="document">
      <button class="modal-close" aria-label="Close trailer" data-close>✕</button>
      <div class="modal-content">
        <iframe id="modalVideo" src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen title="Trailer"></iframe>
      </div>
    </div>
  </div>


  // script.js - immersive experience: preloader, audio, modal player, parallax and lazy-loading.

document.addEventListener('DOMContentLoaded', () => {
  const preloader = document.getElementById('preloader');
  const immersiveBtn = document.getElementById('immersiveBtn');
  const bgVideo = document.getElementById('bg-video');
  const ambient = document.getElementById('ambientAudio');
  const fullscreenBtn = document.getElementById('fullscreenBtn');
  const toggleAudio = document.getElementById('toggleAudio');
  const playerModal = document.getElementById('playerModal');
  const scenePlayer = document.getElementById('scenePlayer');
  const closeModal = document.getElementById('closeModal');
  const thumbs = document.querySelectorAll('.thumb');
  const lazyImages = document.querySelectorAll('img.lazy');

  // Hide preloader when media is ready-ish
  let loaded = false;
  const hidePre = () => {
  };
  // if bg video canplay, hide preloader
  bgVideo.addEventListener('canplay', hidePre);
  // fallback timeout
  setTimeout(hidePre, 3000);

  // Lazy load images
  const lazyObserver = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if (e.isIntersecting){
        const img = e.target;
        img.src = img.dataset.src;
        img.classList.remove('lazy');
        lazyObserver.unobserve(img);
      }
    });
  }, {rootMargin:'200px'});
  lazyImages.forEach(img => lazyObserver.observe(img));

  // Play ambient audio on first user gesture
  function tryStartAmbient() {
  }
  document.addEventListener('click', tryStartAmbient, {once:true});

  // Toggle ambient manually
  toggleAudio.addEventListener('click', () => {
    if (ambient.paused) ambient.play();
    else ambient.pause();
    toggleAudio.innerText = ambient.paused ? 'Toggle Ambient' : 'Ambient On';
  });

  // Immersive entry: bring focus, start interactions
  immersiveBtn.addEventListener('click', async () => {
    // ensure ambient starts
    ambient.play().catch(()=>{});
    // request fullscreen for immersive effect
    try {
      await document.documentElement.requestFullscreen();
    } catch (e){}
    // subtle zoom-in effect: scale video slightly
    bgVideo.style.transform = 'scale(1.06)';
    // focus hero for keyboard accessibility
    document.getElementById('hero').focus();
  });

  // Fullscreen toggle (controls)
  fullscreenBtn.addEventListener('click', async () => {
    if (!document.fullscreenElement){
      try { await document.documentElement.requestFullscreen(); } catch(e){}
    } else {
      try { await document.exitFullscreen(); } catch(e){}
    }
  });

  // Thumbnails open modal and load the scene video
  thumbs.forEach(t => {
    t.addEventListener('click', () => {
      const src = t.dataset.video;
      scenePlayer.src = src;
      playerModal.setAttribute('aria-hidden','false');
      // ensure focus inside modal
      scenePlayer.focus();
      // play when loaded
      scenePlayer.play().catch(()=>{});
    });
  });

  closeModal.addEventListener('click', () => {
    scenePlayer.pause();
    scenePlayer.src = '';
    playerModal.setAttribute('aria-hidden','true');
  });

  // Close modal with Escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      if (playerModal.getAttribute('aria-hidden') === 'false') {
        closeModal.click();
      } else if (document.fullscreenElement) {
        document.exitFullscreen();
      }
    }
  });

  // Parallax subtle effect on mouse move
  document.addEventListener('mousemove', (e) => {
    const x = (e.clientX / window.innerWidth) - 0.5;
    const y = (e.clientY / window.innerHeight) - 0.5;
    const rotateX = y * 3;
    const rotateY = x * -3;
    // apply slight transform to overlay hero elements
    const hero = document.getElementById('hero');
    hero.style.transform = `translateZ(0) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
  });

  // Small idle animation to keep atmosphere
  setInterval(() => {
    // toggles video brightness for breathing effect
    const flicker = (Math.random() > 0.92);
    bgVideo.style.filter = flicker ? 'brightness(.45) contrast(1.05)' : 'brightness(.55) contrast(.95)';
  }, 2200);

  // Accessibility: ensure ambient is paused on page hide
  document.addEventListener('visibilitychange', () => {
    if (document.hidden) ambient.pause();
    else ambient.play().catch(()=>{});
  });

  // Clean up on unload
  window.addEventListener('beforeunload', () => {
    ambient.pause();
    scenePlayer.pause();
  });
});

  <script src="script.js" type="module"></script>
</body>
</html>
